<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36" version="29.1.0">
  <diagram name="Page-1" id="_omLd40gxrhuzkDiTgc6">
    <mxGraphModel dx="2276" dy="1958" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-118" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="105" width="410" x="1910" y="251" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-25" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="" vertex="1">
          <mxGeometry height="60" width="40" x="903" y="1065" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-3" connectable="0" parent="1" style="group" value="&#xa;&#xa;&#xa;User" vertex="1">
          <mxGeometry height="50" width="85" x="320" y="60" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-1" parent="wvIRAx71RviLsR0cLW7b-3" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/active_directory/laptop_client.svg;" value="" vertex="1">
          <mxGeometry height="50" width="45" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-2" parent="wvIRAx71RviLsR0cLW7b-3" style="sketch=0;aspect=fixed;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;fillColor=#00188D;shape=mxgraph.azure.mobile" value="" vertex="1">
          <mxGeometry height="50" width="35" x="50" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-24" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="wvIRAx71RviLsR0cLW7b-5" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-4" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="LB" vertex="1">
          <mxGeometry height="30" width="87" x="320" y="170" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-36" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="wvIRAx71RviLsR0cLW7b-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-6" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="110" width="540" x="-270" y="410" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-12" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="wvIRAx71RviLsR0cLW7b-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-14" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="wvIRAx71RviLsR0cLW7b-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-15" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="wvIRAx71RviLsR0cLW7b-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-23" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="wvIRAx71RviLsR0cLW7b-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-31" connectable="0" parent="wvIRAx71RviLsR0cLW7b-23" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="WebSocket" vertex="1">
          <mxGeometry relative="1" x="-0.057" y="2" as="geometry">
            <mxPoint x="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Y2KK1EN5YpUlUEhctsno-11" connectable="0" parent="wvIRAx71RviLsR0cLW7b-23" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="1 &lt;br&gt;User1 Send message to chat Srv" vertex="1">
          <mxGeometry relative="1" x="0.7652" y="-4" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-5" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="WebServer" vertex="1">
          <mxGeometry height="30" width="87" x="320" y="240" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-7" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="ServiceDiscovery" vertex="1">
          <mxGeometry height="40" width="100" x="-240" y="450" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-8" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="AuthenticationAPI" vertex="1">
          <mxGeometry height="40" width="100" x="-120" y="450" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-9" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="GroupManagement" vertex="1">
          <mxGeometry height="40" width="100" x="10" y="450" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-10" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="UserProfile" vertex="1">
          <mxGeometry height="40" width="100" x="130" y="450" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-11" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="Stateless" vertex="1">
          <mxGeometry height="30" width="60" x="-270" y="410" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-13" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.4;entryY=0.25;entryDx=0;entryDy=0;entryPerimeter=0;" target="wvIRAx71RviLsR0cLW7b-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-32" connectable="0" parent="wvIRAx71RviLsR0cLW7b-13" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="http" vertex="1">
          <mxGeometry relative="1" x="-0.5246" y="-4" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-16" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="110" width="170" x="-270" y="570" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-17" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Chat Server" vertex="1">
          <mxGeometry height="40" width="100" x="-240" y="610" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-21" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="ThirdParty" vertex="1">
          <mxGeometry height="30" width="60" x="-270" y="570" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-22" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="NotificationSystem Design (Push)" vertex="1">
          <mxGeometry height="40" width="100" x="-230" y="620" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-25" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="wvIRAx71RviLsR0cLW7b-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-26" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="wvIRAx71RviLsR0cLW7b-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-63" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" target="wvIRAx71RviLsR0cLW7b-37">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="755" y="625" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Y2KK1EN5YpUlUEhctsno-13" connectable="0" parent="wvIRAx71RviLsR0cLW7b-63" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="3" vertex="1">
          <mxGeometry relative="1" x="-0.5077" y="-2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-27" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="120" width="440" x="610" y="360" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-28" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Chat Server" vertex="1">
          <mxGeometry height="40" width="100" x="690" y="420" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-29" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="Stateful Real time services" vertex="1">
          <mxGeometry height="30" width="150" x="600" y="340" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-77" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" target="wvIRAx71RviLsR0cLW7b-76">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Y2KK1EN5YpUlUEhctsno-12" connectable="0" parent="wvIRAx71RviLsR0cLW7b-77" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="2" vertex="1">
          <mxGeometry relative="1" x="-0.2" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-30" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Chat/WS/Session Servers" vertex="1">
          <mxGeometry height="40" width="100" x="700" y="430" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-33" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Chat Server" vertex="1">
          <mxGeometry height="40" width="100" x="916" y="420" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-86" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="Y2KK1EN5YpUlUEhctsno-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-34" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Presence Servers" vertex="1">
          <mxGeometry height="40" width="100" x="926" y="430" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-35" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.993;entryY=0.645;entryDx=0;entryDy=0;entryPerimeter=0;" target="wvIRAx71RviLsR0cLW7b-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Y2KK1EN5YpUlUEhctsno-18" connectable="0" parent="wvIRAx71RviLsR0cLW7b-35" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="4.b&lt;br&gt;&lt;span style=&quot;font-size: 12px; text-wrap: wrap; background-color: rgb(251, 251, 251);&quot;&gt;&amp;nbsp;send to push notification &lt;br&gt;server if User2 is not online&lt;/span&gt;" vertex="1">
          <mxGeometry relative="1" x="-0.3429" y="-2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-37" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="110" width="540" x="35" y="570" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-38" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="" vertex="1">
          <mxGeometry height="60" width="40" x="105" y="585" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-39" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="" vertex="1">
          <mxGeometry height="60" width="40" x="115" y="595" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-40" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="chat History" vertex="1">
          <mxGeometry height="60" width="40" x="125" y="605" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-43" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="" vertex="1">
          <mxGeometry height="60" width="40" x="265" y="585" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-44" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="" vertex="1">
          <mxGeometry height="60" width="40" x="275" y="595" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-45" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="" vertex="1">
          <mxGeometry height="60" width="40" x="285" y="605" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-46" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="" vertex="1">
          <mxGeometry height="60" width="40" x="415" y="585" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-47" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="" vertex="1">
          <mxGeometry height="60" width="40" x="425" y="595" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-48" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="" vertex="1">
          <mxGeometry height="60" width="40" x="435" y="605" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-49" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="Key-Value DB" vertex="1">
          <mxGeometry height="30" width="90" x="30" y="565" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-50" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.422;entryY=0.018;entryDx=0;entryDy=0;entryPerimeter=0;" target="wvIRAx71RviLsR0cLW7b-37">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-52" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="** Generic data : user profile, settings, friends list are stored in reliable &lt;b&gt;relational DB&lt;/b&gt; with needed sharding and replication for scalability and availability&lt;br&gt;** Chat history data : recommend &lt;b&gt;Key-Value DB&lt;/b&gt; for (easy scale horizontally, low latency, well adopted by FB, Whatsapp also &lt;font color=&quot;#ff5e19&quot;&gt;&lt;b&gt;Relational is not good with long tail&amp;nbsp; of data even with index&lt;/b&gt;&lt;/font&gt;" vertex="1">
          <mxGeometry height="60" width="565" x="22.5" y="688" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-55" parent="1" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" value="1on1 Message" vertex="1">
          <mxGeometry height="120" width="140" x="65" y="770" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-58" parent="wvIRAx71RviLsR0cLW7b-55" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" value="Message_ID (PK)&lt;br&gt;User_from&lt;br&gt;User_to&lt;br&gt;Content&lt;br&gt;created_at" vertex="1">
          <mxGeometry height="90" width="140" y="30" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-59" parent="1" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" value="Group Message" vertex="1">
          <mxGeometry height="120" width="140" x="235" y="770" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-60" parent="wvIRAx71RviLsR0cLW7b-59" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" value="channel_ID&amp;nbsp; &amp;nbsp;(PK). Message_ID (PK)&lt;br&gt;User_id&lt;br&gt;Content&lt;br&gt;created_at" vertex="1">
          <mxGeometry height="90" width="140" y="30" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-61" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="Twitter SnowFlake ID generator for non-SQL DB&amp;nbsp;" vertex="1">
          <mxGeometry height="30" width="160" x="575" y="810" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-69" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Service Discovery(ZooKeeper)" vertex="1">
          <mxGeometry height="20" width="215" x="722.5" y="390" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-70" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="Know list of available servers and assign one after user successfully authenticated" vertex="1">
          <mxGeometry height="30" width="160" x="920" y="230" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-71" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-70" style="endArrow=classic;html=1;rounded=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" target="wvIRAx71RviLsR0cLW7b-69" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="890" y="320" as="sourcePoint" />
            <mxPoint x="940" y="270" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-74" parent="1" style="whiteSpace=wrap;html=1;aspect=fixed;" value="" vertex="1">
          <mxGeometry height="30" width="30" x="630" y="380" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-76" parent="1" style="whiteSpace=wrap;html=1;aspect=fixed;" value="ID Gen." vertex="1">
          <mxGeometry height="30" width="30" x="640" y="385" as="geometry" />
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-78" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-61" style="endArrow=classic;html=1;rounded=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;" target="wvIRAx71RviLsR0cLW7b-76" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="648" y="810" as="sourcePoint" />
            <mxPoint x="680" y="890" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wvIRAx71RviLsR0cLW7b-79" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-61" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="480" y="940" as="sourcePoint" />
            <mxPoint x="378" y="810" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Y2KK1EN5YpUlUEhctsno-1" parent="1" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;FR&lt;/h1&gt;&lt;p&gt;- send message 1on1 Chatting.&lt;br&gt;- Send group message (max 100 people)&lt;br&gt;- Online Status&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="120" width="180" x="-580" y="80" as="geometry" />
        </mxCell>
        <mxCell id="Y2KK1EN5YpUlUEhctsno-2" parent="1" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;NFR&lt;/h1&gt;&lt;p&gt;- Low Latency&lt;/p&gt;&lt;p&gt;- Reliability&lt;/p&gt;&lt;p&gt;- Availability&lt;/p&gt;&lt;p&gt;- Scalability&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="150" width="180" x="-760" y="80" as="geometry" />
        </mxCell>
        <mxCell id="Y2KK1EN5YpUlUEhctsno-3" parent="1" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Size&lt;/h1&gt;&lt;p&gt;- 100M DAU&lt;/p&gt;&lt;p&gt;-&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="120" width="180" x="-580" y="220" as="geometry" />
        </mxCell>
        <mxCell id="Y2KK1EN5YpUlUEhctsno-14" edge="1" parent="1" source="wvIRAx71RviLsR0cLW7b-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" target="wvIRAx71RviLsR0cLW7b-30" value="4.a&amp;nbsp;&lt;br&gt;send to &lt;br&gt;User 2 ChatSrv &lt;br&gt;if user 2 online">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="820" y="450" />
              <mxPoint x="820" y="490" />
              <mxPoint x="775" y="490" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Y2KK1EN5YpUlUEhctsno-19" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="Pub/Sub Redis for all users to register to all users queue" vertex="1">
          <mxGeometry height="30" width="160" x="1091" y="435" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-12" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User A" vertex="1">
          <mxGeometry height="30" width="18" x="850" y="755" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-13" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User B" vertex="1">
          <mxGeometry height="30" width="18" x="1037" y="755" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-30" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-35" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-30" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="3" vertex="1">
          <mxGeometry relative="1" x="0.1942" y="-2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-14" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Chat Server" vertex="1">
          <mxGeometry height="40" width="54" x="832" y="855" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-15" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Chat Server" vertex="1">
          <mxGeometry height="40" width="54" x="1020" y="860" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-17" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-14" style="endArrow=classic;startArrow=classic;html=1;rounded=0;" target="c9I9c8CBazL6Hj6LgtFq-12" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="790" y="870" as="sourcePoint" />
            <mxPoint x="840" y="820" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-34" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-17" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="1" vertex="1">
          <mxGeometry relative="1" x="0.04" y="4" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-18" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-15" style="endArrow=classic;startArrow=classic;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" target="c9I9c8CBazL6Hj6LgtFq-13" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1039.5" y="855.5" as="sourcePoint" />
            <mxPoint x="1039.5" y="780.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-37" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-18" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="6" vertex="1">
          <mxGeometry relative="1" x="0.0129" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-21" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="c9I9c8CBazL6Hj6LgtFq-14" value="2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-20" parent="1" style="whiteSpace=wrap;html=1;aspect=fixed;" value="ID Gen." vertex="1">
          <mxGeometry height="30" width="30" x="770" y="860" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-28" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-32" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-28" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="5.a. if online" vertex="1">
          <mxGeometry relative="1" x="0.5376" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-29" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1047" y="1060" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-33" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-29" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="5.b offline" vertex="1">
          <mxGeometry relative="1" x="0.3252" y="2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-22" parent="1" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;" value="msg syn queue" vertex="1">
          <mxGeometry height="20" width="114" x="880" y="970" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-24" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="KV store" vertex="1">
          <mxGeometry height="60" width="40" x="915" y="1075" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-26" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="40" width="54" x="1010" y="1064" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-27" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="PN servers" vertex="1">
          <mxGeometry height="40" width="54" x="1020" y="1070" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-31" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.855;entryY=0;entryDx=0;entryDy=4.35;entryPerimeter=0;" target="c9I9c8CBazL6Hj6LgtFq-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-36" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-31" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="4" vertex="1">
          <mxGeometry relative="1" x="-0.3637" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-38" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="1:1 chat flow" vertex="1">
          <mxGeometry height="30" width="60" x="920" y="678.75" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-39" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="" vertex="1">
          <mxGeometry height="60" width="40" x="1353" y="1050" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-40" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User B" vertex="1">
          <mxGeometry height="30" width="18" x="1301" y="745" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-41" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User C" vertex="1">
          <mxGeometry height="30" width="18" x="1517" y="745" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-42" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-44" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-56">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-43" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-42" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="3" vertex="1">
          <mxGeometry relative="1" x="0.1942" y="-2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-44" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Chat Server" vertex="1">
          <mxGeometry height="40" width="54" x="1283" y="850" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-45" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Chat Server" vertex="1">
          <mxGeometry height="40" width="54" x="1500" y="850" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-46" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-44" style="endArrow=classic;startArrow=classic;html=1;rounded=0;" target="c9I9c8CBazL6Hj6LgtFq-40" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1270" y="860" as="sourcePoint" />
            <mxPoint x="1320" y="810" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-47" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-46" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="1" vertex="1">
          <mxGeometry relative="1" x="0.04" y="4" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-48" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-45" style="endArrow=classic;startArrow=classic;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" target="c9I9c8CBazL6Hj6LgtFq-41" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1519.5" y="845.5" as="sourcePoint" />
            <mxPoint x="1519.5" y="770.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-49" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-48" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="6" vertex="1">
          <mxGeometry relative="1" x="0.0129" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-50" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="c9I9c8CBazL6Hj6LgtFq-44" value="2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-67" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="c9I9c8CBazL6Hj6LgtFq-64" value="2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1210" y="870" />
              <mxPoint x="1210" y="870" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-51" parent="1" style="whiteSpace=wrap;html=1;aspect=fixed;" value="ID Gen." vertex="1">
          <mxGeometry height="31" width="31" x="1220" y="855" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-52" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-56" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-45">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-53" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-52" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="5.a. if online" vertex="1">
          <mxGeometry relative="1" x="0.5376" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-54" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-56" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-59">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-55" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-54" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="5.b offline" vertex="1">
          <mxGeometry relative="1" x="0.3252" y="2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-56" parent="1" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;" value="msg syn queue" vertex="1">
          <mxGeometry height="20" width="114" x="1330" y="970" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-57" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="KV store" vertex="1">
          <mxGeometry height="60" width="40" x="1365" y="1060" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-58" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="40" width="54" x="1494" y="1054" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-73" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-59" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-72">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-95" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-59" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-93">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-59" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="PN servers" vertex="1">
          <mxGeometry height="40" width="54" x="1500" y="1060" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-60" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-56" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.855;entryY=0;entryDx=0;entryDy=4.35;entryPerimeter=0;" target="c9I9c8CBazL6Hj6LgtFq-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-61" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-60" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="4" vertex="1">
          <mxGeometry relative="1" x="-0.3637" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-62" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="Group chat flow" vertex="1">
          <mxGeometry height="30" width="60" x="1319" y="672.5" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-70" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-63" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-64">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-71" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-70" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="1" vertex="1">
          <mxGeometry relative="1" x="0.253" y="5" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-63" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User A" vertex="1">
          <mxGeometry height="30" width="18" x="1152" y="746" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-68" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-64" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-56">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1160" y="980" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-69" connectable="0" parent="c9I9c8CBazL6Hj6LgtFq-68" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="3" vertex="1">
          <mxGeometry relative="1" x="0.2077" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-64" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="Chat Server" vertex="1">
          <mxGeometry height="40" width="54" x="1134" y="850" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-66" edge="1" parent="1" style="endArrow=none;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1110" y="1160" as="sourcePoint" />
            <mxPoint x="1110" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-75" edge="1" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-45">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1600" y="870" />
            </Array>
            <mxPoint x="1600" y="900" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-72" parent="1" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;rotation=-90;" value="msg syn queue" vertex="1">
          <mxGeometry height="20" width="114" x="1548" y="941" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-91" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User X" vertex="1">
          <mxGeometry height="30" width="18" x="1658" y="740" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-93" parent="1" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;rotation=-90;" value="msg syn queue" vertex="1">
          <mxGeometry height="20" width="114" x="1609" y="940" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-94" edge="1" parent="1" source="c9I9c8CBazL6Hj6LgtFq-93" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.444;entryY=1.033;entryDx=0;entryDy=0;entryPerimeter=0;" target="c9I9c8CBazL6Hj6LgtFq-91">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-96" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="&lt;b&gt;.........&lt;/b&gt;" vertex="1">
          <mxGeometry height="30" width="60" x="1570" y="755" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-97" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="&lt;b&gt;.........&lt;/b&gt;" vertex="1">
          <mxGeometry height="15" width="28" x="1620" y="940" as="geometry" />
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-98" edge="1" parent="1" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-38" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="900" y="510" as="sourcePoint" />
            <mxPoint x="950" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c9I9c8CBazL6Hj6LgtFq-99" edge="1" parent="1" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" target="c9I9c8CBazL6Hj6LgtFq-62" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="904" y="505" as="sourcePoint" />
            <mxPoint x="1330" y="680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-88" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="ESiGrf_ERLCwZTn-2xgo-10" value="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1993" y="-268" />
              <mxPoint x="1993" y="-268" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-4" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="Mobile user" vertex="1">
          <mxGeometry height="30" width="18" x="1983.88" y="-339.25" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-7" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" target="ESiGrf_ERLCwZTn-2xgo-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-8" connectable="0" parent="ESiGrf_ERLCwZTn-2xgo-7" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="WS" vertex="1">
          <mxGeometry relative="1" x="0.0235" y="-3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-9" connectable="0" parent="ESiGrf_ERLCwZTn-2xgo-7" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="2" vertex="1">
          <mxGeometry relative="1" x="-0.7529" y="-2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-10" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="LB" vertex="1">
          <mxGeometry height="30" width="120" x="1933" y="-226.25" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-16" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="30" width="120" x="1823" y="-106.25" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-17" parent="1" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;FR/ Use case:&lt;br&gt;&lt;span style=&quot;background-color: initial; font-size: 12px; font-weight: normal;&quot;&gt;- User see nearby friends in a rang of 5 miles&lt;br&gt;&lt;/span&gt;&lt;font style=&quot;font-size: 12px; font-weight: normal;&quot;&gt;- update friend list each 30 sec&lt;/font&gt;&lt;/h1&gt;" vertex="1">
          <mxGeometry height="110" width="270" x="2163" y="-390" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-18" parent="1" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;NFR:&lt;br&gt;&lt;span style=&quot;background-color: initial; font-size: 12px; font-weight: normal;&quot;&gt;- Low latency&lt;br&gt;&lt;/span&gt;&lt;font style=&quot;font-size: 12px; font-weight: normal;&quot;&gt;- Reliability&lt;br&gt;Eventual Consistency&lt;/font&gt;&lt;/h1&gt;" vertex="1">
          <mxGeometry height="130" width="270" x="2183" y="-290" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-19" parent="1" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Size:&lt;br&gt;&lt;span style=&quot;font-size: 12px; font-weight: 400;&quot;&gt;- 100 Million user&lt;br&gt;- 10% active only&lt;br&gt;-each has 400 friend but app display paging of 20/page&lt;br&gt;&lt;br&gt;QPS = 100 million * 10% / 30 = 334 K QPS&lt;/span&gt;&lt;/h1&gt;" vertex="1">
          <mxGeometry height="240" width="270" x="2183" y="-180" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-20" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="WS servers" vertex="1">
          <mxGeometry height="30" width="120" x="1833" y="-96.25" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-28" parent="1" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" value="Location Cache" vertex="1">
          <mxGeometry height="40" width="100" x="1913" y="-6.25" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-29" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.68;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" target="ESiGrf_ERLCwZTn-2xgo-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-30" connectable="0" parent="ESiGrf_ERLCwZTn-2xgo-29" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="4" vertex="1">
          <mxGeometry relative="1" x="-0.0541" y="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-31" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.375;entryY=0.967;entryDx=0;entryDy=0;entryPerimeter=0;" target="ESiGrf_ERLCwZTn-2xgo-20">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1873" y="-56.25" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-32" connectable="0" parent="ESiGrf_ERLCwZTn-2xgo-31" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="6" vertex="1">
          <mxGeometry relative="1" x="0.1747" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-33" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;rotation=90;" value="" vertex="1">
          <mxGeometry height="113.75" width="50" x="1774.88" y="-48.120000000000005" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-34" connectable="0" parent="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="&lt;b&gt;Redis Pub/Sub&lt;/b&gt;" vertex="1">
          <mxGeometry x="1793" y="13.75" as="geometry">
            <mxPoint x="-7" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-35" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="Multiple servers each maintain set of user connection" vertex="1">
          <mxGeometry height="30" width="120" x="1739.88" y="-160" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-39" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.733;entryDx=0;entryDy=0;entryPerimeter=0;" target="ESiGrf_ERLCwZTn-2xgo-4">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1873" y="-317" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-40" connectable="0" parent="ESiGrf_ERLCwZTn-2xgo-39" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="7" vertex="1">
          <mxGeometry relative="1" x="-0.2289" y="-2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-41" parent="1" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="-&amp;nbsp; Redis message bus. Pub/Sub are very cheap and lightweight&lt;br&gt;&lt;br&gt;- One server can hold &lt;b&gt;Millions &lt;/b&gt;of channels/topic&lt;br&gt;&lt;br&gt;Sent messages are immediately sent to all subscribers&lt;br&gt;&lt;br&gt;if no subscriber message is just dropped" vertex="1">
          <mxGeometry height="185" width="473" x="1379" y="-116.25" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-59" edge="1" parent="1" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1803" y="73.75" as="sourcePoint" />
            <mxPoint x="1920" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-63" edge="1" parent="1" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="ESiGrf_ERLCwZTn-2xgo-87" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1251" y="449" as="sourcePoint" />
            <mxPoint x="1500" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-65" parent="1" style="whiteSpace=wrap;html=1;aspect=fixed;" value="" vertex="1">
          <mxGeometry height="150" width="150" x="1630" y="373.5" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-66" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="GeoHash: 9q8zn6" vertex="1">
          <mxGeometry height="27.5" width="95" x="1657.5" y="386" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-67" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="GeoHash:&lt;br&gt;9q8znf" vertex="1">
          <mxGeometry height="27.5" width="95" x="1657.5" y="478.5" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-68" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="GeoHash:&lt;br&gt;9q8znd" vertex="1">
          <mxGeometry height="27.5" width="95" x="1657.5" y="419.75" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-70" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-67" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" target="ESiGrf_ERLCwZTn-2xgo-68" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <Array as="points">
              <mxPoint x="1705.5" y="458.5" />
            </Array>
            <mxPoint x="1677.5" y="498.5" as="sourcePoint" />
            <mxPoint x="1727.5" y="448.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-87" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="Nearby/online" vertex="1">
          <mxGeometry height="30" width="91" x="1535" y="432.5" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-89" edge="1" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" target="ESiGrf_ERLCwZTn-2xgo-26" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="1953" y="-79.25" as="sourcePoint" />
            <mxPoint x="2183" y="122" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-91" connectable="0" parent="ESiGrf_ERLCwZTn-2xgo-89" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="3" vertex="1">
          <mxGeometry relative="1" x="0.4037" y="-3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-26" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="Location History DB" vertex="1">
          <mxGeometry height="80" width="60" x="2058.63" y="20" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-92" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;" target="ESiGrf_ERLCwZTn-2xgo-33">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1723" y="-81" />
              <mxPoint x="1723" y="9" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-93" connectable="0" parent="ESiGrf_ERLCwZTn-2xgo-92" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="5" vertex="1">
          <mxGeometry relative="1" x="-0.3546" y="-3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-95" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User A" vertex="1">
          <mxGeometry height="30" width="18" x="1979" y="171" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-96" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User B" vertex="1">
          <mxGeometry height="30" width="18" x="2194" y="176" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-99" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="User A WS Server" vertex="1">
          <mxGeometry height="40" width="96" x="1940" y="276" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-100" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="User B WS Server" vertex="1">
          <mxGeometry height="40" width="80" x="2163" y="276" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-101" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-99" style="endArrow=classic;startArrow=classic;html=1;rounded=0;" target="ESiGrf_ERLCwZTn-2xgo-95" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1940" y="291" as="sourcePoint" />
            <mxPoint x="1990" y="241" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-127" connectable="0" parent="ESiGrf_ERLCwZTn-2xgo-101" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="1: User loc update" vertex="1">
          <mxGeometry relative="1" x="0.2" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-103" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-100" style="endArrow=classic;startArrow=classic;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" target="ESiGrf_ERLCwZTn-2xgo-96" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2189.5" y="276.5" as="sourcePoint" />
            <mxPoint x="2189.5" y="201.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-119" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="Session/Websocket &lt;br&gt;server" vertex="1">
          <mxGeometry height="30" width="180" x="2300" y="266" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-120" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="105" width="410" x="1910" y="393.5" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-121" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="Distributed&amp;nbsp; &lt;br&gt;Redis pub/sub" vertex="1">
          <mxGeometry height="30" width="180" x="2290" y="431" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-123" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="User A Channel" vertex="1">
          <mxGeometry height="75" width="32" x="1969" y="411" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-124" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="User B Channel" vertex="1">
          <mxGeometry height="75" width="32" x="2187" y="411" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-128" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="105" width="410" x="1910" y="559" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-129" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User X" vertex="1">
          <mxGeometry height="30" width="18" x="1968" y="721" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-130" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User Z" vertex="1">
          <mxGeometry height="30" width="18" x="2216" y="725" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-131" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="User X WS Server" vertex="1">
          <mxGeometry height="30" width="60" x="1947" y="589.5" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-125" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-99" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="ESiGrf_ERLCwZTn-2xgo-123">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1985" y="341" />
              <mxPoint x="1985" y="341" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-126" connectable="0" parent="ESiGrf_ERLCwZTn-2xgo-125" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="2: Publish" vertex="1">
          <mxGeometry relative="1" x="0.2" y="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-136" parent="1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" value="Session/Websocket &lt;br&gt;server" vertex="1">
          <mxGeometry height="30" width="180" x="2310" y="591" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-138" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="User Y WS Server" vertex="1">
          <mxGeometry height="30" width="60" x="2025" y="591" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-139" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="User W WS Server" vertex="1">
          <mxGeometry height="30" width="60" x="2108" y="589.5" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-140" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="User Z WS Server" vertex="1">
          <mxGeometry height="30" width="60" x="2194" y="591" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-141" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User Y" vertex="1">
          <mxGeometry height="30" width="18" x="2046" y="721" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-144" parent="1" style="html=1;verticalLabelPosition=bottom;align=center;labelBackgroundColor=#ffffff;verticalAlign=top;strokeWidth=2;strokeColor=#0080F0;shadow=0;dashed=0;shape=mxgraph.ios7.icons.smartphone;" value="User W" vertex="1">
          <mxGeometry height="30" width="18" x="2128" y="721" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-145" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-131" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0.067;entryDx=0;entryDy=0;entryPerimeter=0;" target="ESiGrf_ERLCwZTn-2xgo-129">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-146" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-138" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0.033;entryDx=0;entryDy=0;entryPerimeter=0;" target="ESiGrf_ERLCwZTn-2xgo-141">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-147" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-139" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.556;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" target="ESiGrf_ERLCwZTn-2xgo-144">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-148" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-140" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.444;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" target="ESiGrf_ERLCwZTn-2xgo-130">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-153" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-123" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="ESiGrf_ERLCwZTn-2xgo-131" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1810" y="691" as="sourcePoint" />
            <mxPoint x="1860" y="641" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-160" connectable="0" parent="ESiGrf_ERLCwZTn-2xgo-153" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="3: Subscribe" vertex="1">
          <mxGeometry relative="1" x="-0.1149" y="3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-154" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-123" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="ESiGrf_ERLCwZTn-2xgo-138" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1988" y="551" as="sourcePoint" />
            <mxPoint x="1980" y="655" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-155" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-123" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="ESiGrf_ERLCwZTn-2xgo-139" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2050" y="531" as="sourcePoint" />
            <mxPoint x="2120" y="636" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-156" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-124" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" target="ESiGrf_ERLCwZTn-2xgo-139" value="3: Subscribe">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2210" y="481" as="sourcePoint" />
            <mxPoint x="1980" y="645" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-157" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-124" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="ESiGrf_ERLCwZTn-2xgo-140" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1988" y="541" as="sourcePoint" />
            <mxPoint x="2058" y="646" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-158" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-100" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" target="ESiGrf_ERLCwZTn-2xgo-124">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-161" connectable="0" parent="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="2: Publish" vertex="1">
          <mxGeometry x="2090" y="401" as="geometry">
            <mxPoint x="113" y="-30" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-162" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-65" style="shape=flexArrow;endArrow=classic;startArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="ESiGrf_ERLCwZTn-2xgo-120" value="">
          <mxGeometry height="100" relative="1" width="100" as="geometry">
            <Array as="points">
              <mxPoint x="1840" y="446" />
            </Array>
            <mxPoint x="1870" y="531" as="sourcePoint" />
            <mxPoint x="1970" y="431" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ESiGrf_ERLCwZTn-2xgo-163" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="Or GeoHash based" vertex="1">
          <mxGeometry height="30" width="60" x="1820" y="406" as="geometry" />
        </mxCell>
        <mxCell id="KKaNaBtpcP_l4Y0HkDMV-2" parent="1" style="text;whiteSpace=wrap;html=1;" value="&lt;span style=&quot;forced-color-adjust: none; color: rgb(0, 0, 0); font-family: Helvetica; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: nowrap; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 11px; text-align: center; background-color: rgb(255, 255, 255); float: none; display: inline !important;&quot;&gt;&lt;b&gt;When user login;&amp;nbsp;&lt;/b&gt;WS Server do:&lt;br style=&quot;forced-color-adjust: none;&quot;&gt;1- Store location in history DB&lt;br style=&quot;forced-color-adjust: none;&quot;&gt;2- Update user location in cache&lt;br style=&quot;forced-color-adjust: none;&quot;&gt;3- publish to his redis queue&lt;br style=&quot;forced-color-adjust: none;&quot;&gt;4- Get list of firends to cache in memory/local&lt;br&gt;5- Get user&#39;s friends location and calculate distance of who is nearby &lt;br&gt;6- send updated user with latest online list for his friends&lt;/span&gt;&lt;br style=&quot;forced-color-adjust: none; color: light-dark(rgb(0, 0, 0), rgb(237, 237, 237)); font-family: Helvetica; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: nowrap; background-color: rgb(236, 236, 236); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 11px; text-align: center;&quot;&gt;&lt;div style=&quot;text-align: center;&quot;&gt;&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;b&gt;Step 5 to 6 are repeated every 10s to update online list&lt;/b&gt;" vertex="1">
          <mxGeometry height="140" width="341" x="1452" y="-410" as="geometry" />
        </mxCell>
        <mxCell id="KKaNaBtpcP_l4Y0HkDMV-3" edge="1" parent="1" source="ESiGrf_ERLCwZTn-2xgo-16" style="endArrow=none;dashed=1;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" target="KKaNaBtpcP_l4Y0HkDMV-2" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="1480" y="-150" as="sourcePoint" />
            <mxPoint x="1530" y="-200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
